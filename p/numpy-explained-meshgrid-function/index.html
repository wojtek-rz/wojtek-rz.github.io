<!doctype html><html lang=en-gb dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="Nice explanation of the meshgrid function in NumPy"><title>NumPy explained - meshgrid function</title>
<link rel=canonical href=https://wojtek-rz.github.io/p/numpy-explained-meshgrid-function/><link rel=stylesheet href=/scss/style.min.2eb51b5cb500d6ffa39a5cc4303f6a57d40117e2a520061289a834c815b9b01f.css><meta property='og:title' content="NumPy explained - meshgrid function"><meta property='og:description' content="Nice explanation of the meshgrid function in NumPy"><meta property='og:url' content='https://wojtek-rz.github.io/p/numpy-explained-meshgrid-function/'><meta property='og:site_name' content="Wojtek Rzeplinski's website"><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='Python'><meta property='article:tag' content='NumPy'><meta property='article:tag' content='Data Science'><meta property='article:published_time' content='2024-10-12T00:00:00+00:00'><meta property='article:modified_time' content='2024-10-12T00:00:00+00:00'><meta name=twitter:title content="NumPy explained - meshgrid function"><meta name=twitter:description content="Nice explanation of the meshgrid function in NumPy"><link rel="shortcut icon" href=/favicon.png></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu8172189377105849349.jpg width=300 height=300 class=site-logo loading=lazy alt=Avatar></a></figure><div class=site-meta><h1 class=site-name><a href=/>Wojtek Rzeplinski's website</a></h1><h2 class=site-description>Machine learning student at the University of Warsaw.</h2></div></header><ol class=menu-social><li><a href=https://github.com/wojtek-rz target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://www.linkedin.com/in/wojtekrzeplinski/ target=_blank title=Linkedin rel=me><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li><a href=/links/><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>Links</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Dark Mode</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#introduction---how-to-keep-array-of-points-in-2d-space>Introduction - How to keep array of points in 2D space?</a></li><li><a href=#meshgrid---what-is-it>Meshgrid - what is it?</a></li><li><a href=#why-not-use-1-dim-arrays>Why not use 1-dim arrays?</a></li><li><a href=#the-indexing-parameter>The &lsquo;indexing&rsquo; parameter</a></li><li><a href=#the-sparse-parameter>The &lsquo;sparse&rsquo; parameter</a></li><li><a href=#conclusion>Conclusion</a></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/tutorials/>Tutorials</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/numpy-explained-meshgrid-function/>NumPy explained - meshgrid function</a></h2><h3 class=article-subtitle>Nice explanation of the meshgrid function in NumPy</h3></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Oct 12, 2024</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>9 minute read</time></div></footer></div></header><section class=article-content><p>When searching the web for explanations of <code>numpy.meshgrid</code> function, I found that most of them are useless. They contain very abstract description copied from the documentation and provide one simple example that doesn&rsquo;t explain anything why it works the way it does. And in many cases they forgot that more than 2 dimensions exist. And what is this <code>indexing='ij'</code> parameter? In this post I will try to explain how <code>meshgrid</code> works and why it is useful.</p><h2 id=introduction---how-to-keep-array-of-points-in-2d-space><a href=#introduction---how-to-keep-array-of-points-in-2d-space class=header-anchor></a>Introduction - How to keep array of points in 2D space?</h2><p>Imagine a problem, that you have to store some function $f(x) = y$ on the Cartesian plane (meaning &ldquo;x-y&rdquo; plane).
To keep things simple let&rsquo;s assume the function is $f(x) = x^2$.
A person not familiar with numpy or programming, but familiar with discrete functions from the school, would probably write something like this:</p><p><strong>First approach:</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># &#34;arr&#34; is an array of values</span>
</span></span><span class=line><span class=cl><span class=n>arr</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>arr</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=n>arr</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=o>=</span> <span class=mi>4</span>
</span></span><span class=line><span class=cl><span class=n>arr</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span> <span class=o>=</span> <span class=mi>9</span>
</span></span><span class=line><span class=cl><span class=n>arr</span><span class=p>[</span><span class=mi>4</span><span class=p>]</span> <span class=o>=</span> <span class=mi>16</span>
</span></span><span class=line><span class=cl><span class=c1>#in general: arr[x] = y</span>
</span></span></code></pre></td></tr></table></div></div><p>But this code has various problems. It only works when the &ldquo;x&rdquo; values are non-negative integers. When you have some function that doesn&rsquo;t have discrete values or they don&rsquo;t appear in equal intervals, you can&rsquo;t store it in this way. The natural way to store such a function is to create a <strong>new array, that represents the the &ldquo;x&rdquo; values</strong>. This way, to store one function (or one set of points on the graph), you need two arrays: one for &ldquo;x&rdquo; values and one for &ldquo;y&rdquo; values.</p><p><strong>Better approach:</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>x</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>y</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>9</span><span class=p>,</span> <span class=mi>16</span><span class=p>])</span>
</span></span></code></pre></td></tr></table></div></div><p>In this case, the &ldquo;x&rdquo; array represents simple indexes, but in general it can be any array of values. As a generalization, we will think of this two arrays as a set of points in 2D space. Some confusion may arise from the fact, that each point has index, so we have like 3 things: index, x value and y value. But the order of the points is actually not as important as it may seem.</p><p>Let&rsquo;s do the plot of this two functions:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>matplotlib.pyplot</span> <span class=k>as</span> <span class=nn>plt</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>x</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>y</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>9</span><span class=p>,</span> <span class=mi>16</span><span class=p>,</span> <span class=mi>25</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=s1>&#39;ro&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Changing the order of the points...</span>
</span></span><span class=line><span class=cl><span class=n>x</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=mi>3</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>4</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>y</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=mi>9</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>25</span><span class=p>,</span> <span class=mi>16</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># does it change the plot?</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=s1>&#39;ro&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p><img src=/p/numpy-explained-meshgrid-function/2024-10-12-meshgrid_files/2024-10-12-meshgrid_2_0.png width=543 height=413 srcset="/p/numpy-explained-meshgrid-function/2024-10-12-meshgrid_files/2024-10-12-meshgrid_2_0_hu5327014475683305555.png 480w, /p/numpy-explained-meshgrid-function/2024-10-12-meshgrid_files/2024-10-12-meshgrid_2_0_hu9706165383509683289.png 1024w" loading=lazy alt=png class=gallery-image data-flex-grow=131 data-flex-basis=315px></p><p><img src=/p/numpy-explained-meshgrid-function/2024-10-12-meshgrid_files/2024-10-12-meshgrid_2_1.png width=543 height=413 srcset="/p/numpy-explained-meshgrid-function/2024-10-12-meshgrid_files/2024-10-12-meshgrid_2_1_hu5327014475683305555.png 480w, /p/numpy-explained-meshgrid-function/2024-10-12-meshgrid_files/2024-10-12-meshgrid_2_1_hu9706165383509683289.png 1024w" loading=lazy alt=png class=gallery-image data-flex-grow=131 data-flex-basis=315px></p><p>After changing the order of the points, the plot looks the same.</p><p>Note that the continous functions are also stored that way. If you think about this, it&rsquo;s not possible to store infinite number of points in the computer memory. What we have to do is to store some of them and if they are close enough, we won&rsquo;t see the difference. To store a continous function in the computer memory to use it in some way, we have to create two arrays:
one for &ldquo;x&rdquo; values and one for &ldquo;y&rdquo; values. The &ldquo;x&rdquo; values are usually generated by using <code>np.linspace</code> or <code>np.arange</code> function.</p><p><strong>In general, when we want to store some N-dimensional set of points in numpy, we have to create N arrays.</strong></p><h2 id=meshgrid---what-is-it><a href=#meshgrid---what-is-it class=header-anchor></a>Meshgrid - what is it?</h2><p>The <code>meshgrid</code> function is a way to create a grid of points in a many dimensional space. Simmilary to the graphs we generated above, we want to create graphs that will represent a grid of points.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>gx</span><span class=p>,</span> <span class=n>gy</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>meshgrid</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=mi>6</span><span class=p>),</span> <span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=mi>6</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>gx</span><span class=p>,</span> <span class=n>gy</span><span class=p>,</span> <span class=s1>&#39;o&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p><img src=/p/numpy-explained-meshgrid-function/2024-10-12-meshgrid_files/2024-10-12-meshgrid_5_0.png width=534 height=413 srcset="/p/numpy-explained-meshgrid-function/2024-10-12-meshgrid_files/2024-10-12-meshgrid_5_0_hu14928872166949992371.png 480w, /p/numpy-explained-meshgrid-function/2024-10-12-meshgrid_files/2024-10-12-meshgrid_5_0_hu4030102482710682576.png 1024w" loading=lazy alt=png class=gallery-image data-flex-grow=129 data-flex-basis=310px></p><p>Each point has coordinates <code>(x_1, x_2, x_3, ..., x_N)</code>, where <code>x_1</code> is the coordinate of the first axis, <code>x_2</code> is the coordinate of the second axis and so on. The grid is created by taking all possible combinations of the points from the input arrays. We can imagine that each input array great a line, and the points are where the lines intersect.</p><p>The output of the <code>meshgrid</code> function is a list of arrays, where each array represents one dimension.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;gx:&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>gx</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;gy:&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>gy</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><pre><code>gx:
[[0 1 2 3 4 5]
 [0 1 2 3 4 5]
 [0 1 2 3 4 5]
 [0 1 2 3 4 5]
 [0 1 2 3 4 5]
 [0 1 2 3 4 5]]
gy:
[[0 0 0 0 0 0]
 [1 1 1 1 1 1]
 [2 2 2 2 2 2]
 [3 3 3 3 3 3]
 [4 4 4 4 4 4]
 [5 5 5 5 5 5]]
</code></pre><p>We have array of values of the first dimension x - gx and array of values of the second dimension y - gy. One point one grid has it&rsquo;s position determined by the coresponding values in each array - see the ilustration below. The point takes it&rsquo;s first dimension value from the gx array and the second dimension value from the gy array.</p><p><img src=/p/numpy-explained-meshgrid-function/2024-10-12-meshgrid_files/screenshot.png width=539 height=654 srcset="/p/numpy-explained-meshgrid-function/2024-10-12-meshgrid_files/screenshot_hu8016046939532002911.png 480w, /p/numpy-explained-meshgrid-function/2024-10-12-meshgrid_files/screenshot_hu8756571112508235526.png 1024w" loading=lazy alt="Screenshot from 2024-10-12 21-36-43.png" class=gallery-image data-flex-grow=82 data-flex-basis=197px></p><p>In the introduction I said that each point on the graph has also it&rsquo;s index in the arrays, that is not important (as the order is not important). Here, each point has two indices, because we have two dimension.</p><h2 id=why-not-use-1-dim-arrays><a href=#why-not-use-1-dim-arrays class=header-anchor></a>Why not use 1-dim arrays?</h2><p>When I try to flatten the 2D coords arrays to 1D arrays, I have:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>gx</span> <span class=o>=</span> <span class=n>gx</span><span class=o>.</span><span class=n>flatten</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>gy</span> <span class=o>=</span> <span class=n>gy</span><span class=o>.</span><span class=n>flatten</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;gx:&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>gx</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;gy:&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>gy</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>gx</span><span class=p>,</span> <span class=n>gy</span><span class=p>,</span> <span class=s1>&#39;o&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><pre><code>gx:
[0 1 2 3 4 5 0 1 2 3 4 5 0 1 2 3 4 5 0 1 2 3 4 5 0 1 2 3 4 5 0 1 2 3 4 5]
gy:
[0 0 0 0 0 0 1 1 1 1 1 1 2 2 2 2 2 2 3 3 3 3 3 3 4 4 4 4 4 4 5 5 5 5 5 5]
</code></pre><p><img src=/p/numpy-explained-meshgrid-function/2024-10-12-meshgrid_files/2024-10-12-meshgrid_9_1.png width=534 height=413 srcset="/p/numpy-explained-meshgrid-function/2024-10-12-meshgrid_files/2024-10-12-meshgrid_9_1_hu12645546182342016098.png 480w, /p/numpy-explained-meshgrid-function/2024-10-12-meshgrid_files/2024-10-12-meshgrid_9_1_hu8650582429665530684.png 1024w" loading=lazy alt=png class=gallery-image data-flex-grow=129 data-flex-basis=310px></p><p>We have exacly the same output. The reason for that is simple. I pointed out that the indices are not important, but the values are. The values are the coordinates of the points. So I changed the indices of the points and everything still works.
If I would write the meshgrid function by myself, I would probably use 1D arrays, because it&rsquo;s simpler. But the numpy developers decided to use multi-dimensional arrays.</p><p>One of the answers it is easier to futher use the meshgrid values in our computations, because we can predict what the values are. When we take meshgrid arrays:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># x, y are 1D arrays</span>
</span></span><span class=line><span class=cl><span class=n>gx</span><span class=p>,</span> <span class=n>gy</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>meshgrid</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>the following property holds (you can check it by yourself on the examples above):</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>gx</span><span class=p>[</span><span class=n>i</span><span class=p>,</span> <span class=n>j</span><span class=p>]</span> <span class=o>==</span> <span class=n>x</span><span class=p>[</span><span class=n>j</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>gy</span><span class=p>[</span><span class=n>i</span><span class=p>,</span> <span class=n>j</span><span class=p>]</span> <span class=o>==</span> <span class=n>y</span><span class=p>[</span><span class=n>i</span><span class=p>]</span>
</span></span></code></pre></td></tr></table></div></div><p>In the <code>gx</code> array, the value is determined entirely by the second index, and in the <code>gy</code> array, the value is determined entirely by the first index.</p><p>This is very useful, because we can easily see what the values are and how they are ordered, but also what are the dimensions of the arrays.</p><h2 id=the-indexing-parameter><a href=#the-indexing-parameter class=header-anchor></a>The &lsquo;indexing&rsquo; parameter</h2><p>When I read the description of this parameter the first thing I tried was transposing the output arrays. But that gave exacly the same graph as before, so I though to myself: &ldquo;What is the point of this parameter?&rdquo;.</p><p>The <code>indexing</code> parameter is used to which array should be the first one in the indices of each points.</p><p>If you looked confused about the previous paragraph, when the first coordinate <code>i</code> in <code>gx[i,j]</code> what the one that corresponded with the second array <code>y</code> then here&rsquo;s the answer. If you have <code>xy</code> cartesian plane, then the <code>x</code> coordinate actualy points to imaginary &ldquo;column&rdquo; of numbers in space, and the <code>y</code> parameter points to the &ldquo;row&rdquo; of numbers. Because the <code>meshgrid</code> function output should be interpreted as a matrix, when input is on the cartesian plane, the first two dimensions are swapped.</p><p>There are two possible values of the <code>indexing</code> parameter: <code>'xy'</code> and <code>'ij'</code>. The default value is <code>'xy'</code> and was explained above. When you set it to <code>'ij'</code>, you use matrix indexing in the input arrays, so the first array is the first dimension in the grid arrays and the second array is the second dimension. In <code>ij</code> mode, the following property holds:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>gx</span><span class=p>[</span><span class=n>i</span><span class=p>,</span> <span class=n>j</span><span class=p>]</span> <span class=o>==</span> <span class=n>x</span><span class=p>[</span><span class=n>i</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>gy</span><span class=p>[</span><span class=n>i</span><span class=p>,</span> <span class=n>j</span><span class=p>]</span> <span class=o>==</span> <span class=n>y</span><span class=p>[</span><span class=n>j</span><span class=p>]</span>
</span></span></code></pre></td></tr></table></div></div><p>In 90% of the cases you won&rsquo;t need to know the difference. But there is simple example, when it matters. When you are iterating over the grid arrays, you have to know which dimensions are on which position.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>x</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=mi>10</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>y</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=mi>6</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>gx</span><span class=p>,</span> <span class=n>gy</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>meshgrid</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>x</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>y</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>        <span class=n>gx</span><span class=p>[</span><span class=n>i</span><span class=p>,</span><span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span> <span class=c1># do something with gx[i,j]</span>
</span></span><span class=line><span class=cl>        <span class=n>gy</span><span class=p>[</span><span class=n>i</span><span class=p>,</span><span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span>
</span></span></code></pre></td></tr></table></div></div><pre><code>---------------------------------------------------------------------------

IndexError                                Traceback (most recent call last)

Cell In[35], line 6
      4 for i in range(len(x)):
      5     for j in range(len(y)):
----&gt; 6         gx[i,j] = 0 # do something with gx[i,j]
      7         gy[i,j] = 0


IndexError: index 6 is out of bounds for axis 0 with size 6
</code></pre><p>The correct code would be:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>x</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=mi>10</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>y</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=mi>6</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>gx</span><span class=p>,</span> <span class=n>gy</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>meshgrid</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>y</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>x</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>        <span class=n>gx</span><span class=p>[</span><span class=n>i</span><span class=p>,</span><span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span> <span class=c1># do something with gx[i,j]</span>
</span></span><span class=line><span class=cl>        <span class=n>gy</span><span class=p>[</span><span class=n>i</span><span class=p>,</span><span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=the-sparse-parameter><a href=#the-sparse-parameter class=header-anchor></a>The &lsquo;sparse&rsquo; parameter</h2><p>The &lsquo;sparse&rsquo; parameter is used to return the output arrays as sparse matrices.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>gx</span><span class=p>,</span> <span class=n>gy</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>meshgrid</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=mi>6</span><span class=p>),</span> <span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=mi>6</span><span class=p>),</span> <span class=n>sparse</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;gx:&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>gx</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;gy:&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>gy</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><pre><code>gx:
[[0 1 2 3 4 5]]
gy:
[[0]
 [1]
 [2]
 [3]
 [4]
 [5]]
</code></pre><p>This strange form of the output uses the broadcast mechanism to save memory.</p><p>The broadcast is a mechanism that allows numpy to perform operations on arrays of different shapes. The dimensions are compatible, when they are equal or one of them is 1. For example, arrays of shape (3, 1, 3) and (1, 4, 1) are compatible and the resulting array will have shape (3, 4, 3). You can think of this as repeating the smaller array along the missing dimensions, so that it matches the shape of the larger array. In our example (3,1,3) is broadcasted to (3,4,3) by repeating the second dimension 4 times, so accesing (i, j, k) is the same as accesing (i, 0, k).</p><p>The sparse output is a way to save memory, because if we have a function like this: $f(x,y) = x^2 + y^2$</p><p>we can use broadcast mechanism on the output of the meshgrid function.
Output dimensions in the example are <code>gx.shape=(6, 1)</code> and gy.shape=(1, 6). The resulting array will have shape (6, 6) and the value at position (i, j) will be <code>gx[i, 0]**2 + gy[0, j]**2</code>. So to calculate the function values we would do:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>f_values</span> <span class=o>=</span> <span class=n>gx</span> <span class=o>**</span> <span class=mi>2</span> <span class=o>+</span> <span class=n>gy</span> <span class=o>**</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;f_values:&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>f_values</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><pre><code>f_values:
[[ 0  1  4  9 16 25]
 [ 1  2  5 10 17 26]
 [ 4  5  8 13 20 29]
 [ 9 10 13 18 25 34]
 [16 17 20 25 32 41]
 [25 26 29 34 41 50]]
</code></pre><h2 id=conclusion><a href=#conclusion class=header-anchor></a>Conclusion</h2><p>It is much easier to understand something when you know why it was created that way. I hope that this post helped you to understand the <code>meshgrid</code> function and why it is useful. If you have any questions or suggestions, please let me know in the comments.</p></section><footer class=article-footer><section class=article-tags><a href=/tags/python/>Python</a>
<a href=/tags/numpy/>NumPy</a>
<a href=/tags/data-science/>Data Science</a></section><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section></footer><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css integrity=sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV crossorigin=anonymous><script src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js integrity=sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUb0ZY0l8 crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js integrity=sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05 crossorigin=anonymous defer></script><script>window.addEventListener("DOMContentLoaded",()=>{renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}],ignoredClasses:["gist"]})})</script></article><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article><a href=/p/dive-into-your-assembly-code/><div class=article-details><h2 class=article-title>Dive into your assembly code!</h2></div></a></article><article><a href=/p/one-word-on-copy-constructors/><div class=article-details><h2 class=article-title>One Word on Copy Constructors</h2></div></a></article><article><a href=/p/global-variables-in-haskell-with-monadreader/><div class=article-details><h2 class=article-title>Global variables in Haskell with MonadReader!</h2></div></a></article></div></div></aside><footer class=site-footer><section class=copyright>&copy;
2024 Wojtek Rzeplinski's website</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.27.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>